<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orbis Arcana - Waiting Room</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="container">
        <h1 class="title">Orbis Arcana</h1>
        <p>üîÆ A new challenge is coming soon. Stay tuned!</p>
        <p id="status">Checking for new levels...</p>

<!-- üì¢ Announcements Section -->
<div id="announcements-section">
    <p id="announcements">Loading announcements...</p>
</div>

    </div>

    <script type="module">
        import { riddles } from "./levels.js";

const urlParams = new URLSearchParams(window.location.search);
const lastLevel = parseInt(urlParams.get("level")) || 2;
const nextLevel = lastLevel + 1;

async function checkForNewLevels() {
    console.log("üîç Checking for new levels...");

    // ‚úÖ Force Fetch Latest Data (Bypassing Cache)
    try {
        const response = await fetch("levels.js?t=" + new Date().getTime()); // ‚úÖ Bypass cache
        if (!response.ok) {
            throw new Error("Failed to fetch levels.js");
        }
    } catch (error) {
        console.error("‚ùå Error fetching levels.js:", error);
    }

    // ‚úÖ Now Check If Next Level Exists
    if (riddles[nextLevel]) {
        console.log("üéâ New level found! Redirecting...");
        window.location.href = `level.html?level=${nextLevel}`;
    } else {
        document.getElementById("status").innerText = "No new levels yet. Keep waiting...";
    }
}

// ‚úÖ Check Every 3 Seconds Instead of 5
setInterval(checkForNewLevels, 3000);


        // üîπ ANNOUNCEMENTS SYSTEM (Only Message)
async function loadAnnouncements() {
    try {
        let response = await fetch("announcements.json");
        let data = await response.json();
        document.getElementById("announcements").innerText = data.message;
    } catch (error) {
        console.error("‚ùå Error loading announcements:", error);
        document.getElementById("announcements").innerText = "Failed to load announcements.";
    }
}

// Load announcements on page load
loadAnnouncements();

    </script>
</body>
</html>
